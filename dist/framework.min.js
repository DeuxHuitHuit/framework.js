/*! framework.js - v1.7.0 - 501e89810e - build 156 - 2017-11-27
 * https://github.com/DeuxHuitHuit/framework.js
 * Copyright (c) 2017 Deux Huit Huit (https://deuxhuithuit.com/);
 * MIT */
!function(e,r,n){"use strict";var t=function(r){var n=null===r,t=void 0!==r,o=!e.isArray(r),i=!!r&&!e.isNumeric(r.length),a="string"===e.type(r),s=!!r&&!!r.jquery;return(n||t&&o&&(i||a||s))&&(r=[r]),r},o=function(r,n){try{if(n=t(n),e.isFunction(r))return r.apply(this,n||[]);if(e.isPlainObject(r))return r}catch(e){var o=e.stack,i=(e.message||e)+"\n"+(o||"");App.log({args:[i,e],fx:"error"})}},i=function(e,r,n,t,a){n=Math.max(n||0,100),t=t||10;var s=o(e,[a=a||1]);if(s)return o(r,[s,a]);a<t&&setTimeout(i,n,e,r,n,t,a+1)};r.App=e.extend(r.App,{callback:o,loaded:i})}(jQuery,window),function(e,r,n){"use strict";var t={},o=function(){return{init:e.noop}},i=function(r){return e.extend(o(),r)};r.App=e.extend(r.App,{components:{models:function(){return t},create:function(r,n){if(!t[r])return App.log({args:["Component %s is not found",r],fx:"error"}),i({});var o=t[r];return e.isFunction(o)?i(o.call(o,n)):(App.log({args:["Component %s is not a function",r],fx:"error"}),i({}))},exports:function(r,n,o){if(e.type(r)){if(!t[r]||o)return t[r]=n,n;App.log({args:["Overwriting component key %s is not allowed",r],fx:"error"})}else App.log({args:["`key` must be a string",r],fx:"error"});return!1}}})}(jQuery,window),function(e,r,n){"use strict";var t=!1,o=function(r){r.args&&!e.isArray(r.args)&&(r.args=[r.args]);var n={args:r.args||arguments,fx:r.fx||"warn",me:r.me||"App"},t=e.type(n.args[0]);return"string"!==t&&"number"!==t&&"boolean"!=t||(n.args[0]="["+n.me+"] "+n.args[0]),n},i=[];r.App=e.extend(r.App,{debug:function(e){return!0===e||!1===e?t=e:"!"===e&&(t=!t),t},log:function(r){if(!r)return this;var n=o(r);return t&&(e.isFunction(console[n.fx])||(n.fx="log"),window.console[n.fx].apply?window.console[n.fx].apply(window.console,n.args):e.each(n.args,function(e,r){window.console[n.fx](r)})),i.push(n),this},logs:function(){return i}})}(jQuery,window),function(e,r,n){"use strict";var t=function(){var n=/\+/g,t=/([^&=]+)=?([^&]*)/gi,o=function(e){return decodeURIComponent(e.replace(n," "))};return{parse:function(e){var r,n,i={};for(""===e||e||(e=window.location.search),n=e.substring(1);r=t.exec(n);)i[o(r[1])]=o(r[2]);return i},stringify:function(n){var t=[];return e.each(n,function(e,n){n&&t.push(e+"="+r.encodeURIComponent(n))}),t.length?"?"+t.join("&"):""}}}(),o=function(){var e=function(e){return e||window.navigator.userAgent},r=function(r,n){return n=e(n),r.test(n)},n={isTablet:function(e){return n.isMobile(e)&&!n.isPhone(e)},isTablette:function(e){return this.isTablet(e)},isIos:function(e){return n.isIphone(e)||n.isIpad(e)},isIphone:function(e){return!n.isIpad(e)&&(r(/iPhone/i,e)||r(/iPod/i,e))},isIpad:function(e){return r(/iPad/i,e)},isAndroid:function(e){return r(/Android/i,e)},isAndroidPhone:function(e){return n.isAndroid(e)&&r(/mobile/i,e)},isPhone:function(e){return!n.isIpad(e)&&(n.isOtherPhone(e)||n.isAndroidPhone(e)||n.isIphone(e))},isOtherPhone:function(e){return r(/phone/i,e)},isOtherMobile:function(e){return r(/mobile/i,e)||n.isOtherPhone(e)},isMobile:function(e){return n.isIos(e)||n.isAndroid(e)||n.isOtherMobile(e)},isMsie:function(e){return r(/msie/im,e)||r(/trident/im,e)},isSafari:function(e){return!r(/Chrome/i,e)&&r(/Safari/i,e)},isFirefox:function(e){return r(/Firefox/i,e)},isEdge:function(e){return r(/Edge/i,e)},isChrome:function(e){return r(/Chrome/i,e)&&!n.isEdge()}};return n}();r.App=e.extend(r.App,{routing:{querystring:t},device:{detector:o,iphone:o.isIphone(),ipad:o.isIpad(),ios:o.isIos(),android:o.isAndroid(),mobile:o.isMobile(),phone:o.isPhone(),tablet:o.isTablet(),chrome:o.isChrome(),firefox:o.isFirefox(),safari:o.isSafari(),internetexplorer:o.isMsie(),edge:o.isEdge(),events:{click:"click",enter:"pointerenter",up:"pointerup",down:"pointerdown",move:"pointermove",over:"pointerover",out:"pointerout",leave:"pointerleave"}}}),r.QueryStringParser=t,r.QS=t.parse(),r.BrowserDetector=o,e.chrome=o.isChrome(),e.firefox=o.isFirefox(),e.safari=o.isSafari(),e.internetexplorer=o.isMsie(),e.edge=o.isEdge(),e.iphone=o.isIphone(),e.ipad=o.isIpad(),e.ios=o.isIos(),e.mobile=o.isMobile(),e.android=o.isAndroid(),e.phone=o.isPhone(),e.tablet=o.isTablet(),e.touch=e.ios||e.android,e.click=App.device.events.click}(jQuery,window),function(e,r,n){"use strict";var t={},o=function(){return{actions:e.noop,init:e.noop}},i=function(r){return e.extend(o(),r)};r.App=e.extend(r.App,{modules:{models:function(){return t},exports:function(r,n,o){return e.type(r)?t[r]&&!o?App.log({args:["Overwriting module key %s is not allowed",r],fx:"error"}):t[r]=i(n):App.log({args:["`key` must be a string",r],fx:"error"}),t[r]},notify:function(r,n,o){return e.isFunction(n)&&!o&&(o=n,n=void 0),e.each(t,function(e){var t=App._callAction(this.actions,r,n,o);void 0!==t&&App.callback(o,[e,t])}),this}}})}(jQuery,window),function(e,r,n){"use strict";var t={},o={},i=function(r,n,t){var o=function(){return!0},i=function(e){App.callback(e)},a={actions:e.noop,init:e.noop,enter:i,leave:i,canEnter:o,canLeave:o};return function(o){var i,s=o;if(e.isPlainObject(n))i=n;else{if(!e.isFunction(n))return App.log({args:["The exported page model must be an object or a function, `%s` given (%s)",e.type(n),n],fx:"error"}),null;if(i=n.call(this,r,s,t),!e.isPlainObject(i))return App.log({args:["The exported page model function must return an object, `%s` given (%s)",e.type(i),i],fx:"error"}),null}var u=function(){return s.key},p={key:u,loaded:function(){return!!e(u()).length},routes:function(){return s.routes},data:function(){return s}};return e.extend(!0,{},a,i,p)}},a=function(r,n,o){var i=e.type(r);if("string"!==i)App.log({args:["`key` must be a string, `%s` given (%s).",i,r],fx:"error"});else{if(!t[r]||o)return t[r]=n,n;App.log({args:["Overwriting page model key `%s` is not allowed",r],fx:"error"})}return!1},s=function(e){var r=!1;return e?r=!0:App.log({args:"No route set.",fx:"error"}),r},u={regexp:function(e,r,n){if(e.test(r))return n()},string:function(e,r,n){var t;if(r=decodeURIComponent(r),r=r.split("#")[0],e==r)return n();0!==e.indexOf("^")&&(e="^"+e),e.indexOf("^")!==e.length-1&&(e+="$"),e.indexOf("*")&&(e=e.replace(new RegExp("\\*","gi"),".*"));try{t=new RegExp(e)}catch(r){App.log({args:["Error while creating RegExp %s.\n%s",e,r],fx:"error"})}return t&&t.test(r)?n():void 0}},p=function(r,n){var t=-1,o=function(e){return t=e,!1};return"string"!==e.type(r)?(App.log({args:"`route` must be a string",fx:"error"}),t):(~r.indexOf("?")&&(r=r.split("?")[0]),r&&n&&e.each(n,function(n,t){var i=e.type(t),a=u[i];return e.isFunction(a)?a(t,r,function(){return o(n)}):t!==r||o(n)}),t)},c=function(r){var n=null;return s(r)&&e.each(o,function(){var e=this.routes();if(~p(r,e))return n=this,!1}),n};r.App=e.extend(r.App,{pages:{_matchRoute:p,_validateRoute:s,instances:function(e){return e?o[e]:o},models:function(){return t},getPageForRoute:c,page:function(e){var r=o[e];return r||(r=c(e)),r},create:function(e,r,n){var i,a=t[r];if(a){if(!o[e.key]||n)return(i=a(e))&&(o[e.key]=i),i;App.log({args:["Overwriting page key `%s` is not allowed",e.key],fx:"error"})}else App.log({args:["Model `%s` not found",r],fx:"error"});return!1},exports:function(e,r,n){var t=i(e,r,n);return a(e,t,n)}}})}(jQuery,window),function(e,r,n){"use strict";var t="body",o=!1,i=document.location.href.substring(document.location.protocol.length+2+document.location.host.length),a=null,s=null,u="",p=function(r,n,t){if(a){e.isFunction(n)&&!t&&(t=n,n=void 0);var o=App._callAction(a.actions,r,n);void 0!==o&&App.callback(t,[a.key(),o])}return this},c=function(){return o&&App.log({args:"Mediator is busy waiting for a page load.",fx:"error"}),!o},l=function(e){var r=!0;return e||(r=!1),r},f=function(e){var r=!0;return e.canEnter()||(App.log("Cannot enter page %s.",e.key()),r=!1),r},g=function(){var e=!1;return a?a.canLeave()?e=!0:App.log("Cannot leave page %s.",a.key()):App.log({args:"No current page set.",fx:"error"}),e},d=function(e,r,n){return p(e,r,n),App.modules.notify(e,r,n),this},h=function(r,n){var i,p="",d=function(r){try{return e(r)}catch(e){App.log({args:[e.message],fx:"error"}),App.modules.notify("pages.failedtoparse",{data:r,route:p,nextPage:i,currentPage:a})}return e()},h=function(){var e=a,r=function(){a=null,s=e,u=n||document.location.href.substring(document.location.protocol.length+2+document.location.host.length),e=null,App.modules.notify("page.leave",{page:s})},t=function(){a=i,App.modules.notify("page.enter",{page:i,route:p}),o=!1},c={currentPage:a,nextPage:i,leaveCurrent:r,enterNext:t,route:p,isHandled:!1};App.modules.notify("pages.requestPageTransition",c),i.isInited||(i.init(),i.isInited=!0),c.isHandled||(App.modules.notify("page.leaving",{page:e}),e.leave(r),App.modules.notify("page.entering",{page:i,route:p}),i.enter(t))};return c()&&g()&&("string"===e.type(r)?(i=App.pages.getPageForRoute(r),p=r):i=r,l(i)?f(i)?i===a?(App.modules.notify("pages.navigateToCurrent",{page:i,route:p}),App.log("next page is the current one")):(App.modules.notify("pages.loading",{page:i}),App.modules.notify("pages.requestBeginPageTransition",{currentPage:a,nextPage:i,route:p}),i.loaded()?(h(),App.modules.notify("pages.loaded",{elem:e(t),url:r,page:i})):(o=!0,Loader.load({url:r,priority:0,vip:!0,success:function(n,s,u){var c=d(n),f=c.find(i.key()),g=e(t),m=c.find(t+" > [data-response-url]").attr("data-response-url");if(m&&m!=r.split("#")[0]){var v=i;if(i=App.pages.getPageForRoute(m),App.modules.notify("pages.redirected",{currentPage:a,nextPage:i,redirectedPage:v,requestedRoute:p,responseRoute:m}),App.modules.notify("pages.requestCancelPageTransition",{currentPage:a,nextPage:i,route:p}),!l(i))return App.modules.notify("pages.routeNotFound",{page:a,url:r,isRedirect:!0}),void App.log({args:['Redirected route "%s" was not found.',r],fx:"error"});f=c.find(i.key()),i===a?(App.modules.notify("pages.navigateToCurrent",{page:i,route:p,isRedirect:!0}),App.log("redirected next page is the current one")):App.modules.notify("pages.requestBeginPageTransition",{currentPage:a,nextPage:i,route:m,isRedirect:!0})}f.length?(g.append(f.css({opacity:0})),i.init(),i.isInited=!0,f.hide(),App.modules.notify("pages.loaded",{elem:g,data:n,url:r,page:i,node:f,xhr:u,status:s}),h()):(App.log({args:['Could not find "%s" in xhr data.',i.key()],fx:"error"}),o=!1,App.modules.notify("pages.notfound",{data:n,url:r,xhr:u,status:s}))},progress:function(e){var n=e.originalEvent.total,t=e.originalEvent.loaded,o=n>0?t/n:0;App.mediator.notify("pages.loadprogress",{event:e,url:r,total:n,loaded:t,percent:o})},error:function(e){App.modules.notify("pages.loaderror",{event:e,url:r})},giveup:function(e){o=!1,App.log({args:"Giving up!",me:"Loader"}),App.modules.notify("pages.loadfatalerror",{event:e,url:r})}}))):App.log({args:['Route "%s" is invalid.',r],fx:"error"}):(App.modules.notify("pages.routeNotFound",{page:a,url:r}),App.log({args:['Route "%s" was not found.',r],fx:"error"}))),this},m=function(r){r&&e(r).length&&(t=r),e.each(App.modules.models(),function(){this.init()}),e.each(App.pages.instances(),function(){this.loaded()&&(this.init({firstTime:!0}),this.isInited=!0,~App.pages._matchRoute(i,this.routes())&&(a=this,s=this,App.modules.notify("page.entering",{page:a,route:i}),a.enter(function(){App.modules.notify("page.enter",{page:a,route:i})})))}),d("app.init",{page:a})};r.App=e.extend(r.App,{_callAction:function(r,n,t){if(e.isFunction(r)&&(r=r()),r){var o=r[n];if(!e.isFunction(o)&&~n.indexOf(".")){o=r;var i=n.split(".");e.each(i,function(){return o=o[this],!!e.isPlainObject(o)})}return App.callback(o,[n,t])}},root:function(){return t},run:function(e){return m(e),App},mediator:{_currentPage:function(e){return e&&(a=e),a},getCurrentPage:function(){return a},notify:d,notifyCurrentPage:p,goto:h,toggle:function(e,r){if(a&&c()){var n=App.pages.getPageForRoute(e);l(n)&&f(n)&&(n!==a?h(e):u?h(u):r?h(r):App.modules.notify("page.toggleNoPreviousUrl",{currentPage:n}))}return this}}})}(jQuery,window),function(e,r,n){"use strict";r.keys={"?":0,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,space_bar:32,page_up:33,page_down:34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,left_window_key:91,right_window_key:92,select_key:93,numpad_0:96,numpad_1:97,numpad_2:98,numpad_3:99,"numpad 4":100,numpad_5:101,numpad_6:102,numpad_7:103,numpad_8:104,numpad_9:105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,";":186,"=":187,equal_sign:187,comma:188,", ":188,dash:189,"ff-dash":173,".":190,period:190,forward_slash:191,"/":191,grave_accent:192,open_bracket:219,back_slash:220,"\\":220,close_braket:221,single_quote:222},r.keyFromCode=function(r){var n="?";return r?(e.each(window.keys,function(e,t){return r!==t||(n=e,!1)}),n):n},r.isChar=function(e){return e===window.keys.space_bar||e>window.keys[0]&&e<=window.keys.z}}(jQuery,window),function(e,r,n){"use strict";var t=["iphone","ipad","ios","android","mobile","phone","tablet","touch","chrome","firefox","safari","internetexplorer","edge"];e.each(t,function(r,n){e[n]&&e("html").addClass(n)}),e.easing.def=e.mobile?"linear":"easeOutQuad";var o=["assert","clear","count","debug","dir","dirxml","error","group","group","group","info","log","profile","profile","time","time","time","trace","warn"];r.console||(r.console={}),e.each(o,function(n,t){r.console[t]=r.console[t]||e.noop}),r.pd=function(r,n){return r&&(e.isFunction(r.preventDefault)&&r.preventDefault(),!1!==n&&e.isFunction(r.stopPropagation)&&r.stopPropagation()),!1}}(jQuery,window),function(e,r,n){"use strict";!function(){var r=e.ajaxSettings.xhr;e.ajaxSetup({progress:e.noop,upload:e.noop,xhr:function(){var n=this,t=r();return t&&(e.isFunction(t.addEventListener)&&t.addEventListener("progress",function(r){n.progress(e.Event(r))},!1),t.upload&&e.isFunction(t.upload.addEventListener)&&t.upload.addEventListener("progress",function(r){n.upload(e.Event(r))},!1)),t}})}();var t=[],o=!1,i=null,a=function(r){return e.isPlainObject(r)||(r={url:r}),(!r.method||"GET"===r.method)&&(!!i&&i===r.url)},s=function(r){var n=-1;return e.each(t,function(e,t){return t.url!==r||(n=e,!1)}),n},u=function(e){return!0===e.cache&&(e.cache="session"),r.AppStorage&&r.AppStorage[e.cache]},p=e.noop,c=e.noop,l=function(e){return{progress:function(){App.callback.call(this,e.progress,arguments)},success:function(r){if(i=null,p(),App.callback.call(this,e.success,arguments),e.cache){var n=u(e);n&&n.set(e.url,r)}},error:function(){var r=e.vip?2:1;i=null,App.log({args:["Error loading url %s",e.url],me:"Loader"}),e.priority+=++e.retries,e.retries<=e.maxRetries*r?c(e):App.callback.call(this,e.giveup,arguments),p(),App.callback.call(this,e.error,arguments)}}},f=function(){var r=t.shift(),n=e.extend({},r,l(r));e.ajax(n),i=n.url};p=function(){t.length?f():o=!1};var g=function(r,n){return e.isPlainObject(r)||(r={url:r}),e.isNumeric(n)&&Math.abs(n)<t.length&&(r.priority=n),(!e.isNumeric(r.priority)||Math.abs(r.priority)>t.length)&&(r.priority=t.length),e.isNumeric(r.retries)||(r.retries=0),e.isNumeric(r.maxRetries)||(r.maxRetries=2),r},d=function(){o||(o=!0,f(),App.log({args:"Load worker has been started",me:"Loader"}))},h=function(e){var r=u(e);if(r){var n=r.get(e.url);if(n&&!1!==App.callback.call(this,e.cachehit,n))return App.callback.call(this,e.success,n),!0}return!1},m=function(e,r){var n=t[r];n.priority!=e.priority&&(t.splice(r,1),t.splice(e.priority,1,e)),App.log({args:["Url %s was shifted from %s to %s",e.url,n.priority,e.priority],me:"Loader"})};c=function(e,r){if(!e)return App.log({args:"No url given",me:"Loader"}),this;if(e=g(e,r),a(e))return App.log({args:["Url %s is already loading",e.url],me:"Loader"}),this;if(e.cache&&h(e))return this;var n=s(e.url);return~n?m(e,n):(t.splice(e.priority,1,e),App.log({args:["Url %s has been insert at %s",e.url,e.priority],me:"Loader"})),d(),this},r.Loader=e.extend(r.Loader,{load:c,isLoading:a,inQueue:s,working:function(){return o}})}(jQuery,window),function(e,r,n){"use strict";var t=function(e){return{get:function(r){if(r)return r+="",e[r]},set:function(r,n){var t=!1;if(r){r+="";try{e[r]=n?n+"":"",t=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),t=!1}}return t},remove:function(r){var n=!1;if(r){r+="";try{e.removeItem(r),n=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),n=!1}}return n},clear:function(r){var n=!1;try{if(r){for(var t=[],o=0;o<e.length;o++){var i=e.key(o);r.test(i)&&t.push(i)}for(o=0;o<t.length;o++)e.removeItem(t[o])}else e.clear();n=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),n=!1}return n}}};r.AppStorage=e.extend(r.AppStorage,{factory:t,local:t(window.localStorage),session:t(window.sessionStorage)}),r.Storage=e.extend(r.Storage,r.AppStorage)}(jQuery,window);
//# sourceMappingURL=framework.min.js.map