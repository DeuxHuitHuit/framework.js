/*! framework.js - v1.4.0 - build 135 - 2016-03-23
* https://github.com/DeuxHuitHuit/framework.js
* Copyright (c) 2016 Deux Huit Huit; Licensed  */

!function(a,b,c){"use strict";var d=function(b,d){try{if(null!==d&&(d===c||a.isArray(d)||a.isNumeric(d.length)&&"string"!==a.type(d)&&!d.jquery)||(d=[d]),a.isFunction(b))return b.apply(this,d||[]);if(a.isPlainObject(b))return b}catch(e){var f=e.stack,g=(e.message||e)+"\n"+(f||"");App.log({args:[g,e],fx:"error"})}return c},e=function(a,b,c,f,g){c=Math.max(c||0,100),f=f||10,g=g||1;var h=d(a,[g]);return h?d(b,[h,g]):void(f>g&&setTimeout(e,c,a,b,c,f,g+1))};b.App=a.extend(b.App,{callback:d,loaded:e})}(jQuery,window),function(a,b,c){"use strict";var d={},e=function(){return{init:a.noop}},f=function(b){return a.extend(e(),b)},g=function(b,c,e){if(a.type(b)){if(!d[b]||e)return d[b]=c,c;App.log({args:["Overwriting component key %s is not allowed",b],fx:"error"})}else App.log({args:["`key` must be a string",b],fx:"error"});return!1},h=function(b,c){if(!d[b])return App.log({args:["Component %s is not found",b],fx:"error"}),f({});var e=d[b];return a.isFunction(e)?f(e.call(e,c)):(App.log({args:["Component %s is not a function",b],fx:"error"}),f({}))};b.App=a.extend(b.App,{components:{models:function(){return d},create:h,exports:g}})}(jQuery,window),function(a,b,c){"use strict";var d=!1,e=function(a){return a===!0||a===!1?d=a:"!"===a&&(d=!d),d},f=[],g=function(b){if(!b)return this;b.args&&!a.isArray(b.args)&&(b.args=[b.args]);var c={args:b.args||arguments,fx:b.fx||"warn",me:b.me||"App"},e=a.type(c.args[0]);return("string"===e||"number"===e||"boolean"==e)&&(c.args[0]="["+c.me+"] "+c.args[0]),d&&(a.isFunction(console[c.fx])||(c.fx="log"),window.console[c.fx].apply?window.console[c.fx].apply(window.console,c.args):a.each(c.args,function(a,b){window.console[c.fx](b)})),f.push(c),this};b.App=a.extend(b.App,{debug:e,log:g,logs:function(){return f}})}(jQuery,window),function(a,b,c){"use strict";var d={},e=function(){return{actions:a.noop,init:a.noop}},f=function(b){return a.extend(e(),b)},g=function(b,c,e){return a.type(b)?d[b]&&!e?App.log({args:["Overwriting module key %s is not allowed",b],fx:"error"}):d[b]=f(c):App.log({args:["`key` must be a string",b],fx:"error"}),d[b]},h=function(b,e,f){return a.isFunction(e)&&!f&&(f=e,e=c),a.each(d,function(a){var d=App._callAction(this.actions,b,e,f);d!==c&&App.callback(f,[a,d])}),this};b.App=a.extend(b.App,{modules:{models:function(){return d},exports:g,notify:h}})}(jQuery,window),function(a,b,c){"use strict";var d={},e={},f=function(b,c,d){var e=function(){return!0},f=function(a){App.callback(a)},g={actions:a.noop,init:a.noop,enter:f,leave:f,canEnter:e,canLeave:e},h=function(e){var f,h=e;if(a.isPlainObject(c))f=c;else{if(!a.isFunction(c))return App.log({args:["The exported page model must be an object or a function, `%s` given (%s)",a.type(c),c],fx:"error"}),null;if(f=c.call(this,b,h,d),!a.isPlainObject(f))return App.log({args:["The exported page model function must return an object, `%s` given (%s)",a.type(f),f],fx:"error"}),null}var i=function(){return h.key},j=function(){return h.routes},k=function(){return!!a(i()).length},l=function(){return h},m={key:i,loaded:k,routes:j,data:l};return a.extend(!0,{},g,f,m)};return h},g=function(a,b,c){var f,g=d[b];if(g){if(!e[a.key]||c)return f=g(a),f&&(e[a.key]=f),f;App.log({args:["Overwriting page key `%s` is not allowed",a.key],fx:"error"})}else App.log({args:["Model `%s` not found",b],fx:"error"});return!1},h=function(b,c,e){var f=a.type(b);if("string"!==f)App.log({args:["`key` must be a string, `%s` given (%s).",f,b],fx:"error"});else{if(!d[b]||e)return d[b]=c,c;App.log({args:["Overwriting page model key `%s` is not allowed",b],fx:"error"})}return!1},i=function(a,b,c){var d=f(a,b,c);return h(a,d,c)},j=function(a){var b=!1;return a?b=!0:App.log({args:"No route set.",fx:"error"}),b},k=function(b,c){var d=-1,e=function(a){return d=a,!1};return"string"!==a.type(b)?(App.log({args:"`route` must be a string",fx:"error"}),d):(~b.indexOf("?")&&(b=b.split("?")[0]),b&&c&&a.each(c,function(c){var d,f=this,g=a.type(f);if("regexp"==g){if(f.test(b))return e(c)}else if("string"==g){if(b=decodeURIComponent(b),b=b.split("#")[0],f==b)return e(c);0!==f.indexOf("^")&&(f="^"+f),f.indexOf("^")!==f.length-1&&(f+="$"),f.indexOf("*")&&(f=f.replace(new RegExp("\\*","gi"),".*"));try{d=new RegExp(f)}catch(h){App.log({args:["Error while creating RegExp %s.\n%s",f,h],fx:"error"})}if(d&&d.test(b))return e(c)}else if(f===b)return e(c);return!0}),d)},l=function(b){var c=null;return j(b)&&a.each(e,function(){var a=this.routes();return~k(b,a)?(c=this,!1):void 0}),c};b.App=a.extend(b.App,{pages:{_matchRoute:k,_validateRoute:j,instances:function(a){return a?e[a]:e},models:function(){return d},getPageForRoute:l,page:function(a){var b=e[a];return b||(b=l(a)),b},create:g,exports:i}})}(jQuery,window),function(a,b,c){"use strict";var d="body",e=!1,f=document.location.href.substring(document.location.protocol.length+2+document.location.host.length),g=null,h=null,i="",j=function(b,c,d){if(a.isFunction(b)&&(b=b()),b){var e=b[c];if(!a.isFunction(e)&&~c.indexOf(".")){e=b;var f=c.split(".");a.each(f,function(){return e=e[this],a.isPlainObject(e)?!0:!1})}return App.callback(e,[c,d])}},k=function(b,d,e){if(g){a.isFunction(d)&&!e&&(e=d,d=c);var f=App._callAction(g.actions,b,d);f!==c&&App.callback(e,[g.key(),f])}return this},l=function(){return e&&App.log({args:"Mediator is busy waiting for a page load.",fx:"error"}),!e},m=function(a){var b=!0;return a||(b=!1),b},n=function(a){var b=!0;return a.canEnter()||(App.log("Cannot enter page %s.",a.key()),b=!1),b},o=function(){var a=!1;return g?g.canLeave()?a=!0:App.log("Cannot leave page %s.",g.key()):App.log({args:"No current page set.",fx:"error"}),a},p=function(a,b,c){return k(a,b,c),App.modules.notify(a,b,c),this},q=function(b,c){var f,j="",k=function(){var a=g,b=function(){g=null,h=a,i=c?c:document.location.href.substring(document.location.protocol.length+2+document.location.host.length),a=null,App.modules.notify("page.leave",{page:h})},d=function(){g=f,App.modules.notify("page.enter",{page:f,route:j}),e=!1},k={currentPage:g,nextPage:f,leaveCurrent:b,enterNext:d,route:j,isHandled:!1};App.modules.notify("pages.requestPageTransition",k),f.isInited||(f.init(),f.isInited=!0),k.isHandled||(App.modules.notify("page.leaving",{page:a}),a.leave(b),App.modules.notify("page.entering",{page:f,route:j}),f.enter(d))},p=function(c,h,i){var l=a(c),n=l.find(f.key()),o=a(d),p=l.find(d+" > [data-response-url]").attr("data-response-url");if(p&&p!=b){var q=f;if(f=App.pages.getPageForRoute(p),App.modules.notify("pages.redirected",{currentPage:g,nextPage:f,redirectedPage:q,requestedRoute:j,responseRoute:p}),App.modules.notify("pages.requestCancelPageTransition",{currentPage:g,nextPage:f,route:j}),!m(f))return App.modules.notify("pages.routeNotFound",{page:g,url:b,isRedirect:!0}),void App.log({args:['Redirected route "%s" was not found.',b],fx:"error"});n=l.find(f.key()),f===g?(App.modules.notify("pages.navigateToCurrent",{page:f,route:j,isRedirect:!0}),App.log("redirected next page is the current one")):App.modules.notify("pages.requestBeginPageTransition",{currentPage:g,nextPage:f,route:p,isRedirect:!0})}n.length?(o.append(n.css({opacity:0})),f.init(),f.isInited=!0,n.hide(),App.modules.notify("pages.loaded",{elem:o,data:c,url:b,page:f,node:n,xhr:i,status:h}),k()):(App.log({args:['Could not find "%s" in xhr data.',f.key()],fx:"error"}),e=!1,App.modules.notify("pages.notfound",{data:c,url:b,xhr:i,status:h}))},q=function(a){var c=a.originalEvent.total,d=a.originalEvent.loaded,e=c>0?d/c:0;App.mediator.notify("pages.loadprogress",{event:a,url:b,total:c,loaded:d,percent:e})};return l()&&o()&&("string"===a.type(b)?(f=App.pages.getPageForRoute(b),j=b):f=b,m(f)?n(f)?f===g?(App.modules.notify("pages.navigateToCurrent",{page:f,route:j}),App.log("next page is the current one")):(App.modules.notify("pages.loading",{page:f}),App.modules.notify("pages.requestBeginPageTransition",{currentPage:g,nextPage:f,route:j}),f.loaded()?(k(),App.modules.notify("pages.loaded",{elem:a(d),url:b,page:f})):(e=!0,Loader.load({url:b,priority:0,vip:!0,success:p,progress:q,error:function(a){App.modules.notify("pages.loaderror",{event:a,url:b})},giveup:function(a){e=!1,App.log({args:"Giving up!",me:"Loader"}),App.modules.notify("pages.loadfatalerror",{event:a,url:b})}}))):App.log({args:['Route "%s" is invalid.',b],fx:"error"}):(App.modules.notify("pages.routeNotFound",{page:g,url:b}),App.log({args:['Route "%s" was not found.',b],fx:"error"}))),this},r=function(a,b){if(g&&l()){var c=App.pages.getPageForRoute(a);m(c)&&n(c)&&(c!==g?q(a):i?q(i):b?q(b):App.modules.notify("page.toggleNoPreviousUrl",{currentPage:c}))}return this},s=function(b){b&&a(b).length&&(d=b),a.each(App.modules.models(),function(){this.init()}),a.each(App.pages.instances(),function(){this.loaded()&&(this.init({firstTime:!0}),this.isInited=!0,~App.pages._matchRoute(f,this.routes())&&(g=this,h=this,App.modules.notify("page.entering",{page:g,route:f}),g.enter(function(){App.modules.notify("page.enter",{page:g,route:f})})))}),p("app.init",{page:g})},t=function(a){return s(a),App};b.App=a.extend(b.App,{_callAction:j,root:function(){return d},run:t,mediator:{_currentPage:function(a){return a&&(g=a),g},getCurrentPage:function(){return g},notify:p,notifyCurrentPage:k,"goto":q,toggle:r}})}(jQuery,window),function(a,b,c){"use strict";b.keys={"?":0,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,space_bar:32,page_up:33,page_down:34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,left_window_key:91,right_window_key:92,select_key:93,numpad_0:96,numpad_1:97,numpad_2:98,numpad_3:99,"numpad 4":100,numpad_5:101,numpad_6:102,numpad_7:103,numpad_8:104,numpad_9:105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,";":186,"=":187,equal_sign:187,comma:188,", ":188,dash:189,"ff-dash":173,".":190,period:190,forward_slash:191,"/":191,grave_accent:192,open_bracket:219,back_slash:220,"\\":220,close_braket:221,single_quote:222},b.keyFromCode=function(b){var c="?";return b?(a.each(window.keys,function(a,d){return b===d?(c=a,!1):!0}),c):c},b.isChar=function(a){return a===window.keys.space_bar||a>window.keys[0]&&a<=window.keys.z}}(jQuery,window),function(a,b,c){"use strict";var d=function(){var c=/\+/g,d=/([^&=]+)=?([^&]*)/gi,e=function(a){return decodeURIComponent(a.replace(c," "))},f=function(a){var b,c,f={};for(""===a||a||(a=window.location.search),c=a.substring(1);b=d.exec(c);)f[e(b[1])]=e(b[2]);return f},g=function(c){var d=[];return a.each(c,function(a,c){c&&d.push(a+"="+b.encodeURIComponent(c))}),d.length?"?"+d.join("&"):""};return{parse:f,stringify:g}},e=function(){var a=function(a){return a?a:window.navigator.userAgent},b=function(b,c){return c=a(c),b.test(c)},c={isTablet:function(a){return c.isMobile(a)&&!c.isPhone(a)},isTablette:function(a){return this.isTablet(a)},isIos:function(a){return c.isIphone(a)||c.isIpad(a)},isIphone:function(a){return!c.isIpad(a)&&(b(/iPhone/i,a)||b(/iPod/i,a))},isIpad:function(a){return b(/iPad/i,a)},isAndroid:function(a){return b(/Android/i,a)},isAndroidPhone:function(a){return c.isAndroid(a)&&b(/mobile/i,a)},isPhone:function(a){return!c.isIpad(a)&&(c.isOtherPhone(a)||c.isAndroidPhone(a)||c.isIphone(a))},isOtherPhone:function(a){return b(/phone/i,a)},isOtherMobile:function(a){return b(/mobile/i,a)||c.isOtherPhone(a)},isMobile:function(a){return c.isIos(a)||c.isAndroid(a)||c.isOtherMobile(a)},isMsie:function(a){return b(/msie/im,a)||b(/trident/im,a)}};return c};b.QueryStringParser=d(),b.QS=b.QueryStringParser.parse(),b.BrowserDetector=e(),a.iphone=b.BrowserDetector.isIphone(),a.ipad=b.BrowserDetector.isIpad(),a.ios=b.BrowserDetector.isIos(),a.mobile=b.BrowserDetector.isMobile(),a.android=b.BrowserDetector.isAndroid(),a.phone=b.BrowserDetector.isPhone(),a.tablet=b.BrowserDetector.isTablet(),a.touch=a.ios||a.android,a.click=a.touch?"touch-click":"click",a.tablette=a.tablet,a.touchClick=a.touch}(jQuery,window),function(a,b,c){"use strict";var d=["iphone","ipad","ios","mobile","android","phone","tablet","touch"];if(a.each(d,function(b,c){a[c]&&a("html").addClass(c)}),a.easing.def=a.mobile?"linear":"easeOutQuad",a.touch){var e=!1,f=!1,g={x:0,y:0},h=function(c,d){var e=!0;return a.isFunction(b.preventNextClick)&&(e=b.preventNextClick.call(c,d)),e},i=function(){var c=0;return a.isNumeric(b.deviceMinMoveValue)?c=parseInt(b.deviceMinMoveValue,10):a.isFunction(b.deviceMinMoveValue)&&(c=parseInt(b.deviceMinMoveValue())),c||10},j=0;a(document).on("touchstart",function(a){e=!1;var b=a.originalEvent.touches[0];g.x=b.screenX,g.y=b.screenY,App.log("touchstart",g)}).on("touchmove",function(a){var b=a.originalEvent.changedTouches[0];j||(j=i()*(window.devicePixelRatio||1)),e=1===a.originalEvent.changedTouches.length&&(Math.abs(g.x-b.screenX)>j||Math.abs(g.y-b.screenY)>j),App.log("touchmove",g,e,b.screenX,b.screenY)}).on("touchend",function(c){App.log("touchend",g,e);var d=a(c.target),h="input, select, textarea",i=".ignore-mobile-click, .ignore-mobile-click *",j=d.is(h)||d.is(i);if(f=a.ios&&!j,!e&&!j){var k=a.Event(a.click);if(a(c.target).trigger(k),k.isDefaultPrevented()?b.pd(c,k.isPropagationStopped()):k.isPropagationStopped()&&c.stopPropagation(),c.isDefaultPrevented())return App.log("touchend prevented"),!1}}).on("click","a",function(a){App.log("real click");var c=f&&h(this,a);return f=!1,c?(App.log("click prevented"),b.pd(a),!1):void 0})}var k=["assert","clear","count","debug","dir","dirxml","error","group","group","group","info","log","profile","profile","time","time","time","trace","warn"];b.console||(b.console={}),a.each(k,function(c,d){b.console[d]=b.console[d]||a.noop});var l=function(a){return("0"+parseInt(a,10).toString(16)).slice(-2)};b.rgb2hex=function(a){var b=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return b?l(b[1])+l(b[2])+l(b[3]):a},b.pd=function(b,c){return b&&(a.isFunction(b.preventDefault)&&b.preventDefault(),c!==!1&&a.isFunction(b.stopPropagation)&&b.stopPropagation()),!1}}(jQuery,window),function(a,b,c){"use strict";!function(){var b=a.ajaxSettings.xhr;a.ajaxSetup({progress:a.noop,upload:a.noop,xhr:function(){var c=this,d=b();return d&&(a.isFunction(d.addEventListener)&&d.addEventListener("progress",function(b){c.progress(a.Event(b))},!1),d.upload&&a.isFunction(d.upload.addEventListener)&&d.upload.addEventListener("progress",function(b){c.upload(a.Event(b))},!1)),d}})}();var d=[],e=!1,f=null,g=function(a){return!!f&&f===a},h=function(b){var c=-1;return a.each(d,function(a,d){return d.url===b?(c=a,!1):!0}),c},i=function(a){return a.cache===!0&&(a.cache="session"),b.Storage[a.cache]},j=function(){d.length?k():e=!1},k=function(){var b=d.shift(),c=a.extend({},b,{progress:function(){App.callback.call(this,b.progress,arguments)},success:function(a){if(f=null,j(),App.callback.call(this,b.success,arguments),b.cache){var c=i(b);c&&c.set(b.url,a)}},error:function(){var a=b.vip?2:1;f=null,App.log({args:["Error loading url %s",b.url],me:"Loader"}),b.priority+=++b.retries,b.retries<=b.maxRetries*a?m(b):App.callback.call(this,b.giveup,arguments),j(),App.callback.call(this,b.error,arguments)}});a.ajax(c),f=c.url},l=function(b,c){return a.isPlainObject(b)||(b={url:b}),a.isNumeric(c)&&Math.abs(c)<d.length&&(b.priority=c),(!a.isNumeric(b.priority)||Math.abs(b.priority)>d.length)&&(b.priority=d.length),a.isNumeric(b.retries)||(b.retries=0),a.isNumeric(b.maxRetries)||(b.maxRetries=2),b},m=function(a,b){if(!a)return App.log({args:"No url given",me:"Loader"}),this;if(a=l(a,b),g(a.url))return App.log({args:["Url %s is already loading",a.url],me:"Loader"}),this;if(a.cache){var c=i(a);if(c){var e=c.get(a.url);if(e&&App.callback.call(this,a.cachehit,e)!==!1)return App.callback.call(this,a.success,e),this}}var f=h(a.url);if(~f){var j=d[f];j.priority!=a.priority&&(d.splice(f,1),d.splice(a.priority,1,a)),App.log({args:["Url %s was shifted from %s to %s",a.url,j.priority,a.priority],me:"Loader"})}else d.splice(a.priority,1,a),App.log({args:["Url %s has been insert at %s",a.url,a.priority],me:"Loader"});return n(),this},n=function(){e||(e=!0,k(),App.log({args:"Load worker has been started",me:"Loader"}))};b.Loader=a.extend(b.Loader,{load:m,isLoading:g,inQueue:h,working:function(){return e}})}(jQuery,window),function(a,b,c){"use strict";var d=function(a){return{get:function(b){return b?(b+="",a[b]):void 0},set:function(b,c){var d=!1;if(b){b+="";try{a[b]=c?c+"":"",d=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),d=!1}}return d},remove:function(b){var c=!1;if(b){b+="";try{a.removeItem(b),c=!0}catch(d){App.log({args:d.message,me:"Storage",fx:"error"}),c=!1}}return c},clear:function(b){var c=!1;try{if(b){for(var d=[],e=0;e<a.length;e++){var f=a.key(e);b.test(f)&&d.push(f)}for(e=0;e<d.length;e++)a.removeItem(d[e])}else a.clear();c=!0}catch(g){App.log({args:g.message,me:"Storage",fx:"error"}),c=!1}return c}}};b.Storage=a.extend(b.Storage,{factory:d,local:d(window.localStorage),session:d(window.sessionStorage)})}(jQuery,window);
//# sourceMappingURL=framework.min.js.map