/*! framework.js - v2.2.5 - 5ab75c36d8 - build 175 - 2022-05-26
 * https://github.com/DeuxHuitHuit/framework.js
 * Copyright (c) 2022 Deux Huit Huit (https://deuxhuithuit.com/);
 * MIT */
!function(p,e,c){"use strict";var o={},f=!1,l=[];e.App=p.extend(!0,e.App,{actions:{resolve:function(e,r){if(p.isFunction(e)&&(e=e()),e){var n=e[r];if(!p.isFunction(n)){var t=o[r]||r.split(".");if(t.length<2)return;o[r]=t,n=e,t.every(function(e){return n=n[e],!!p.isPlainObject(n)})}if(p.isFunction(n))return n}},execute:function(e,t,o,i){var r,n=0,u=!1;for(f||(u=f=!0),p.isArray(e)||(e=[e]),p.isFunction(o)&&!i&&(i=o,o=c),e.forEach(function(e,r){var n=App.callback(e,[t,o]);i&&n!==c&&App.callback(i,[r,n]),p.isFunction(n)&&(n={read:null,write:n}),p.isPlainObject(n)&&p.isFunction(n.write)&&(App.debug()&&!n.key&&(n.key=t),l.push(n))});u&&l.length>n;){for(var s=l.length,a=n;a<s;a++)r=l[a],p.isFunction(r.read)&&r.read(t,o);for(a=n;a<s;a++)l[a].write(t,o);n=s}u&&(f=!1,l=[])},stack:function(){return l}}})}(jQuery,window),function(s,e,a){"use strict";e.App=s.extend(!0,e.App,{callback:function(e,r){try{if(r=function(e){var r=null===e,n=e!==a,t=!s.isArray(e),o=!!e&&!s.isNumeric(e.length),i="string"===s.type(e),u=!!e&&!!e.jquery;return(r||n&&t&&(o||i||u))&&(e=[e]),e}(r),s.isFunction(e))return e.apply(this,r||[]);if(s.isPlainObject(e))return e}catch(e){var n=e.stack,t=(e.message||e)+"\n"+(n||"");App.log({args:[t,e],fx:"error"})}return a}})}(jQuery,window),function(t,e){"use strict";function o(e){return t.extend({init:t.noop},e)}var i={};e.App=t.extend(!0,e.App,{components:{models:function(){return i},create:function(e,r){if(!i[e])return App.log({args:["Component %s is not found",e],fx:"error"}),Object.freeze(o({}));var n=i[e];return t.isFunction(n)?Object.freeze(o(n.call(n,r))):(App.log({args:["Component %s is not a function",e],fx:"error"}),Object.freeze(o({})))},exports:function(e,r,n){if("string"!==t.type(e))App.log({args:["`key` must be a string",e],fx:"error"});else{if(!i[e]||n)return i[e]=Object.freeze(r),r;App.log({args:["Overwriting component key %s is not allowed",e],fx:"error"})}return!1}}})}(jQuery,window),function(e,r){"use strict";var n=!1;r.App=e.extend(!0,r.App,{debug:function(e){return!0===e||!1===e?n=e:"!"===e&&(n=!n),n}})}(jQuery,window),function(e,r){"use strict";var n,t=n={isTablet:function(e){return n.isMobile(e)&&!n.isPhone(e)},isTablette:function(e){return this.isTablet(e)},isIos:function(e){return n.isIphone(e)||n.isIpad(e)},isIphone:function(e){return!n.isIpad(e)&&(o(/iPhone/i,e)||o(/iPod/i,e))},isIpad:function(e){return o(/iPad/i,e)},isAndroid:function(e){return o(/Android/i,e)},isAndroidPhone:function(e){return n.isAndroid(e)&&o(/mobile/i,e)},isPhone:function(e){return!n.isIpad(e)&&(n.isOtherPhone(e)||n.isAndroidPhone(e)||n.isIphone(e))},isOtherPhone:function(e){return o(/phone/i,e)},isOtherMobile:function(e){return o(/mobile/i,e)||n.isOtherPhone(e)},isMobile:function(e){return n.isIos(e)||n.isAndroid(e)||n.isOtherMobile(e)},isMsie:function(e){return o(/msie/im,e)||o(/trident/im,e)},isSafari:function(e){return!o(/Chrome/i,e)&&o(/Safari/i,e)},isFirefox:function(e){return o(/Firefox/i,e)},isEdge:function(e){return o(/Edge/i,e)||o(/Edg/i,e)},isChrome:function(e){return o(/Chrome/i,e)&&!n.isEdge()},isMacOs:function(e){return o(/Macintosh/i,e)&&!n.isMobile()},isWindows:function(e){return o(/Windows/i,e)},isLinux:function(e){return o(/Linux/i,e)&&!n.isMobile()}};function o(e,r){return r=function(e){return e||window.navigator.userAgent}(r),e.test(r)}r.App=e.extend(!0,r.App,{device:{detector:t,iphone:t.isIphone(),ipad:t.isIpad(),ios:t.isIos(),android:t.isAndroid(),macos:t.isMacOs(),windows:t.isWindows(),linux:t.isLinux(),mobile:t.isMobile(),phone:t.isPhone(),tablet:t.isTablet(),chrome:t.isChrome(),firefox:t.isFirefox(),safari:t.isSafari(),internetexplorer:t.isMsie(),edge:t.isEdge(),events:{click:"click",enter:"pointerenter",up:"pointerup",down:"pointerdown",move:"pointermove",over:"pointerover",out:"pointerout",leave:"pointerleave"}}})}(jQuery,window),function(t,e){"use strict";var o={};e.App=t.extend(!0,e.App,{fx:{notify:function(e,r,n){var t=o[e];return t?App.actions.execute(t,e,r,n):App.log({args:["Function key %s did not resolve to anything",e],fx:"warn"}),this},exports:function(e,r,n){return"string"!==t.type(e)?App.log({args:["`key` must be a string",e],fx:"error"}):o[e]&&!n?App.log({args:["Overwriting function key %s is not allowed",e],fx:"error"}):t.isFunction(r)?(function(e,r){if(App.debug()&&Object.defineProperty)try{Object.defineProperty(r,"name",{value:e})}catch(e){}}(r),o[e]=Object.freeze(r)):App.log({args:["Function key %s is not a function",e],fx:"error"}),o[e]}}})}(jQuery,window),function(e,r){"use strict";var u=function(e,r,n,t,o){n=Math.max(n||0,100),t=t||10,o=o||1;var i=App.callback(e,[o]);i?setTimeout(function(){App.callback(r,[i,o])},0):o<t?setTimeout(u,n,e,r,n,t,o+1):App.log&&App.log({fx:"error",args:["App.loaded timed out after %s attempts.",o]})};r.App=e.extend(!0,r.App,{loaded:u})}(jQuery,window),function(t,r){"use strict";var n;n=t.ajaxSettings.xhr,t.ajaxSetup({progress:t.noop,upload:t.noop,xhr:function(){var r=this,e=n();return e&&(t.isFunction(e.addEventListener)&&e.addEventListener("progress",function(e){r.progress(t.Event(e))},!1),e.upload&&t.isFunction(e.upload.addEventListener)&&e.upload.addEventListener("progress",function(e){r.upload(t.Event(e))},!1)),e}});function o(e){return t.isPlainObject(e)||(e={url:e}),(!e.method||"GET"===e.method)&&(!!c&&c===e.url)}function i(r){return a.findIndex(function(e){return e.url===r})}function u(e){return!0===e.cache&&(e.cache="session"),r.App.storage&&r.App.storage[e.cache]}function s(){var e=a.shift(),r=t.extend({},e,function(o){return{progress:function(e){App.callback(o.progress,[e])},success:function(e,r,n){if(c=null,f(),App.callback(o.success,[e,r,n]),o.cache){var t=u(o);t&&t.set(o.url,e)}},error:function(e,r,n){var t=o.vip?2:1;c=null,App.log({fx:"error",args:["Error loading url %s: %s",o.url,r+" "+n],me:"Loader"}),o.priority+=++o.retries,400<=e.status&&e.status<500?App.callback(o.clienterror,[e.status,e,r,n]):o.retries<=o.maxRetries*t?l(o):App.callback(o.giveup,[e,r,n]),f(),App.callback(o.error,[e,r,n])}}}(e));t.ajax(r),c=r.url}var a=[],p=!1,c=null,f=t.noop,l=t.noop;f=function(){a.length?setTimeout(s,0):p=!1};l=function(e,r){if(!e)return App.log({fx:"error",args:"No url given",me:"Loader"}),this;if(e=function(e,r){return t.isPlainObject(e)||(e={url:e}),t.isNumeric(r)&&Math.abs(r)<a.length&&(e.priority=r),(!t.isNumeric(e.priority)||Math.abs(e.priority)>a.length)&&(e.priority=a.length),t.isNumeric(e.retries)||(e.retries=0),t.isNumeric(e.maxRetries)||(e.maxRetries=2),e}(e,r),o(e))return App.log({fx:"error",args:["Url %s is already loading",e.url],me:"Loader"}),this;if(e.cache&&function(e){var r=u(e);if(r){var n=r.get(e.url);if(n&&!1!==App.callback(e.cachehit,[n]))return App.callback(e.success,[n]),!0}return!1}(e))return this;var n=i(e.url);return~n?function(e,r){var n=a[r];n.priority!=e.priority&&(a.splice(r,1),a.splice(e.priority,1,e)),App.log({args:["Url %s was shifted from %s to %s",e.url,n.priority,e.priority],me:"Loader"})}(e,n):(a.splice(e.priority,1,e),App.log({fx:"info",args:["Url %s has been insert at %s",e.url,e.priority],me:"Loader"})),p||(p=!0,s(),App.log({fx:"info",args:"Load worker has been started",me:"Loader"})),this},r.App=t.extend(!0,r.App,{loader:{load:l,isLoading:o,inQueue:i,working:function(){return p}}})}(jQuery,window),function(t,e){"use strict";var n=[];e.App=t.extend(!0,e.App,{log:function(e){if(!e)return this;var r=function(e){e.args&&!t.isArray(e.args)&&(e.args=[e.args]);var r={args:e.args||arguments,fx:e.fx||"warn",me:e.me||"App"},n=t.type(r.args[0]);return"string"!==n&&"number"!==n&&"boolean"!=n||(r.args[0]="["+r.me+"] "+r.args[0]),r}(e);return App.debug()&&(t.isFunction(console[r.fx])||(r.fx="log"),window.console[r.fx].apply?window.console[r.fx].apply(window.console,r.args):r.args.forEach(function(e){window.console[r.fx](e)})),n.push(r),this},logs:function(){return n}})}(jQuery,window),function(l,e){"use strict";function i(){return document.location.href.substring(document.location.protocol.length+2+document.location.host.length)}function t(){return d&&App.log({args:"Mediator is busy waiting for a page load.",fx:"error"}),!d}function g(e){var r=!0;return e||(r=!1),r}function u(e){var r=!0;return e.canEnter()||(App.log({fx:"error",args:["Cannot enter page %s.",e.key()]}),r=!1),r}function s(e,r){if(A)return App.actions.resolve(A.actions,e,r);App.log({args:"Can not notify page: No current page set.",fx:"error"})}function o(a,o){function p(){function e(){A=null,v=n,m=o||i(),n=null,App.modules.notify("page.leave",{page:v})}function r(){A=c,App.modules.notify("page.enter",{page:c,route:f}),d=!1}var n=A,t={currentPage:A,nextPage:c,leaveCurrent:e,enterNext:r,route:f,isHandled:!1};App.modules.notify("pages.requestPageTransition",t),c.isInited||(c.init(),c.setInited()),t.isHandled||(App.modules.notify("page.leaving",{page:n}),n.leave(e),App.modules.notify("page.entering",{page:c,route:f}),c.enter(r))}var c,f="";return t()&&function(){var e=!1;return A?A.canLeave()?e=!0:App.log({args:["Cannot leave page %s.",A.key()],fx:"error"}):App.log({args:"No current page set.",fx:"error"}),e}()&&(f="string"===l.type(a)?(c=App.pages.getPageForRoute(a),a):(c=a).route||"",g(c)?u(c)?c===A?(App.modules.notify("pages.navigateToCurrent",{page:c,route:f}),App.log("Next page is the current one")):(App.modules.notify("pages.loading",{page:c}),App.modules.notify("pages.requestBeginPageTransition",{currentPage:A,nextPage:c,route:f}),c.loaded()?(p(),App.modules.notify("pages.loaded",{elem:l(App.root()),url:a,page:c})):(d=!0,App.loader.load({url:a,priority:0,vip:!0,success:function(e,r,n){var t=function(r){try{return l(r)}catch(e){App.log({args:[e.message],fx:"error"}),App.modules.notify("pages.failedtoparse",{data:r,route:f,nextPage:c,currentPage:A})}return l()}(e),o=t.find(c.key()),i=l(App.root()),u=t.find(App.root()+" > [data-response-url]").attr("data-response-url");if(u&&u!=a.split("#")[0]){var s=c;if(c=App.pages.getPageForRoute(u),App.modules.notify("pages.redirected",{currentPage:A,nextPage:c,redirectedPage:s,requestedRoute:f,responseRoute:u}),App.modules.notify("pages.requestCancelPageTransition",{currentPage:A,nextPage:c,requestedRoute:f,route:u}),f=u,!g(c))return App.modules.notify("pages.routeNotFound",{page:A,url:a,isRedirect:!0}),void App.log({args:['Redirected route "%s" was not found.',a],fx:"error"});o=t.find(c.key()),c===A?(App.modules.notify("pages.navigateToCurrent",{page:c,route:f,isRedirect:!0}),App.log("Redirected next page is the current one")):App.modules.notify("pages.requestBeginPageTransition",{currentPage:A,nextPage:c,route:u,isRedirect:!0})}o.length?(i.append(o.css({opacity:0})),c.init(),c.setInited(),o.hide(),App.modules.notify("pages.loaded",{elem:i,data:e,url:f,page:c,node:o,xhr:n,status:r}),p()):(App.log({args:['Could not find "%s" in xhr data.',c.key()],fx:"error"}),d=!1,App.modules.notify("pages.notfound",{data:e,url:a,xhr:n,status:r}))},progress:function(e){var r=e.originalEvent.total,n=e.originalEvent.loaded,t=0<r?n/r:0;App.mediator.notify("pages.loadprogress",{event:e,url:a,total:r,loaded:n,percent:t})},error:function(e){App.modules.notify("pages.loaderror",{event:e,url:a})},giveup:function(e){d=!1,App.log({args:"Giving up!",me:"Loader",fx:"error"}),App.modules.notify("pages.loadfatalerror",{event:e,url:a})}}))):App.log({args:['Route "%s" is invalid.',a],fx:"error"}):(App.modules.notify("pages.routeNotFound",{page:A,url:a}),App.log({args:['Route "%s" was not found.',a],fx:"error"}))),this}var d=!1,r=i(),A=null,v=null,m="";e.App=l.extend(!0,e.App,{mediator:{getCurrentUrl:i,getCurrentPage:function(){return A},setCurrentPage:function(e){A=e},getPreviousUrl:function(){return m},getPreviousPage:function(){return v},notify:function(e,r,n){var t=[],o=s(e,r);return o&&t.push(o),t=t.concat(App.modules.resolve(e,r)),App.actions.execute(t,e,r,n),this},notifyCurrentPage:function(e,r,n){var t=s(e,r);return t&&App.actions.execute([t],e,r,n),this},goto:o,toggle:function(e,r){if(A&&t()){var n=App.pages.getPageForRoute(e);g(n)&&u(n)&&(n!==A?o(e):m&&m!==i()?o(m):r?o(r):App.modules.notify("page.toggleNoPreviousUrl",{currentPage:n}))}return this},init:function(e){~App.pages.matchRoute(r,e.routes())&&(A&&App.log({args:["Previous current page will be changed",{currentPage:A,previousPage:v,newCurrentPage:e}],fx:"warning"}),A=e,v=v||e,App.modules.notify("page.entering",{page:A,route:r}),A.enter(function(){App.modules.notify("page.enter",{page:A,route:r})}))}}})}(jQuery,window),function(t,e){"use strict";function o(e){return Object.freeze(t.extend({actions:t.noop,init:t.noop},e))}function i(r,n){return Object.keys(u).map(function(e){return App.actions.resolve(u[e].actions,r,n)}).filter(function(e){return!!e})}var u={};e.App=t.extend(!0,e.App,{modules:{models:function(){return u},exports:function(e,r,n){return"string"!==t.type(e)?App.log({args:["`key` must be a string",e],fx:"error"}):u[e]&&!n?App.log({args:["Overwriting module key %s is not allowed",e],fx:"error"}):u[e]=o(r),u[e]},notify:function(e,r,n){var t=i(e,r);return App.actions.execute(t,e,r,n),this},resolve:i}})}(jQuery,window),function(p,e){"use strict";function r(e){var r=!1;return e?r=!0:App.log({args:"No route set.",fx:"error"}),r}function t(i,e){var u=-1;return"string"!==p.type(i)?App.log({args:"`route` must be a string",fx:"error"}):(~i.indexOf("?")&&(i=i.split("?")[0]),i&&e&&(Array.isArray(e)||(e=Object.values(e)),e.every(function(e,r){function n(){return function(e){return u=e,!1}(r)}var t=p.type(e),o=s[t];return p.isFunction(o)?o(e,i,n):e!==i||n()}))),u}function n(n){if(r(n)){var e=Object.values(u).find(function(e){var r=e.routes();return!!~t(n,r)});if(e)return e}return null}var i={},u={},s={regexp:function(e,r,n){return!e.test(r)||n()},string:function(r,e,n){var t;if(r==(e=(e=decodeURIComponent(e)).split("#")[0]))return n();0!==r.indexOf("^")&&(r="^"+r),r.indexOf("^")!==r.length-1&&(r+="$"),r.indexOf("*")&&(r=r.replace(new RegExp("\\*","gi"),".*"));try{t=new RegExp(r)}catch(e){App.log({args:["Error while creating RegExp %s.\n%s",r,e],fx:"error"})}return!t||!t.test(e)||n()}};e.App=p.extend(!0,e.App,{pages:{matchRoute:t,validateRoute:r,instances:function(e){return e?u[e]:u},models:function(){return i},getPageForRoute:n,page:function(e){var r=u[e];return r||(r=n(e)),r},create:function(e,r,n){var t,o=i[r];if(o){if(!u[e.key]||n)return(t=o(e))&&(u[e.key]=t),t;App.log({args:["Overwriting page key `%s` is not allowed",e.key],fx:"error"})}else App.log({args:["Model `%s` not found",r],fx:"error"});return!1},exports:function(e,r,n){return function(e,r,n){var t=p.type(e);if("string"!==t)App.log({args:["`key` must be a string, `%s` given (%s).",t,e],fx:"error"});else{if(!i[e]||n)return i[e]=Object.freeze(r),r;App.log({args:["Overwriting page model key `%s` is not allowed",e],fx:"error"})}return!1}(e,function(i,u,s){function e(){return!0}function r(e){App.callback(e)}var a={actions:p.noop,init:p.noop,enter:r,leave:r,canEnter:e,canLeave:e};return function(e){var r,n=!1;if(p.isPlainObject(u))r=u;else{if(!p.isFunction(u))return App.log({args:["The exported page model must be an object or a function, `%s` given (%s)",p.type(u),u],fx:"error"}),null;if(r=u.call(this,i,e,s),!p.isPlainObject(r))return App.log({args:["The exported page model function must return an object, `%s` given (%s)",p.type(r),r],fx:"error"}),null}function t(){return e.key}var o=Object.freeze({key:t,loaded:function(){return!!p(t()).length},routes:function(){return e.routes},data:function(){return e},isInited:function(){return n},setInited:function(){n=!0}});return Object.freeze(p.extend(!0,{},a,r,o))}}(e,r,n),n)}}})}(jQuery,window),function(e,n){"use strict";var r,o,t=(r=/\+/g,o=/([^&=]+)=?([^&]*)/gi,{parse:function(e){var r,n,t={};for(""===e||e||(e=window.location.search),n=e.substring(1);r=o.exec(n);)t[i(r[1])]=i(r[2]);return t},stringify:function(e){var r=Object.entries(e).filter(function(e){return!!e[1]}).map(function(e){return e[0]+"="+n.encodeURIComponent(e[1])});return r.length?"?"+r.join("&"):""}});function i(e){return decodeURIComponent(e.replace(r," "))}n.App=e.extend(!0,n.App,{routing:{querystring:t}})}(jQuery,window),function(e,r){"use strict";function n(i){return{get:function(e){if(e)return i[e+=""]},set:function(e,r){var n=!1;if(e){e+="";try{i[e]=r?r+"":"",n=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),n=!1}}return n},remove:function(e){var r=!1;if(e){e+="";try{i.removeItem(e),r=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),r=!1}}return r},clear:function(e){var r=!1;try{if(e){for(var n=[],t=0;t<i.length;t++){var o=i.key(t);e.test(o)&&n.push(o)}for(t=0;t<n.length;t++)i.removeItem(n[t])}else i.clear();r=!0}catch(e){App.log({args:e.message,me:"Storage",fx:"error"}),r=!1}return r}}}r.App=e.extend(!0,r.App,{storage:{factory:n,local:function(){try{return n(window.localStorage)}catch(e){App.log({args:e.message,me:"Storage",fx:"error"})}return n({})}(),session:function(){try{return n(window.sessionStorage)}catch(e){App.log({args:e.message,me:"Storage",fx:"error"})}return n({})}()}})}(jQuery,window),function(r,n){"use strict";var t="body";n.App=r.extend(!0,n.App,{root:function(){return t},run:function(e){return function(e){e&&r(e).length&&(t=e),Object.values(App.modules.models()).forEach(function(e){e.init()}),Object.values(App.pages.instances()).forEach(function(e){e.loaded()&&(e.init({firstTime:!0}),e.setInited(),App.mediator.init(e))}),App.mediator.notify("app.init",{page:App.mediator.getCurrentPage()}),App.mediator.getCurrentPage()||(App.modules.notify("app.pageNotFound"),App.log({fx:"error",args:"No current page set, pages will not work."}))}(e),n.App}})}(jQuery,window),function(n,r){"use strict";var t;r.App&&r.App.device&&(t=n("html"),["iphone","ipad","ios","android","mobile","phone","tablet","touch","chrome","firefox","safari","internetexplorer","edge"].forEach(function(e){App.device[e]&&t.addClass(e)}),n.easing.def=App.device.mobile?"linear":"easeOutQuad");r.console||(r.console={}),["assert","clear","count","debug","dir","dirxml","error","group","group","group","info","log","profile","profile","time","time","time","trace","warn"].forEach(function(e){r.console[e]=r.console[e]||n.noop}),r.pd=function(e,r){return e&&(n.isFunction(e.preventDefault)&&e.preventDefault(),!1!==r&&n.isFunction(e.stopPropagation)&&e.stopPropagation()),!1}}(jQuery,window);
//# sourceMappingURL=framework.min.js.map