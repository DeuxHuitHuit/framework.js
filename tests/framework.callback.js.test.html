<!DOCTYPE html public "âœ°"> 
<html lang="en"> 
<head> 
	<meta charset="utf-8" /> 
	<title>app-callback.js test suite</title> 
	
	<link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.10.0.css" type="text/css"/>
	
	<style type="text/css">

	</style>
	
	<script>
		(function (w, doc,co) {
			// http://stackoverflow.com/questions/901115/get-query-string-values-in-javascript
			var u = {},
				e,
				a = /\+/g,  // Regex for replacing addition symbol with a space
				r = /([^&=]+)=?([^&]*)/g,
				d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
				q = w.location.search.substring(1),
				v = '1.8';

			while (e = r.exec(q)) {
				u[d(e[1])] = d(e[2]);
			}
			
			if (!!u.jquery) {
				v = u.jquery;
			}	

			doc.write('<script src="http://ajax.googleapis.com/ajax/libs/jquery/'+v+'/jquery.js">' + "<" + '/' + 'script>');
			co.log('\nLoading jQuery v' + v + '\n');
		})(window, document, console);
	</script>
</head>
<body>
	<h1 id="qunit-header">framework.callback.js</h1>  
	<h2 id="qunit-banner"></h2>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	
	<script src="http://code.jquery.com/qunit/qunit-1.10.0.js"></script>
	<!--script src="../src/globals.js"></script-->
	<!--script src="../src/loader.js"></script>-->
	<script src="../src/app-debug.js"></script>
	<script src="../src/app-callback.js"></script>
	
	<script>
	(function ($, w) {
		
		"use strict";
		
		var 
		
		runTests = function  () {
			
			module('App.callback');
			
			test('Callback exist', function AppDebug() {
				//test for initial value
				ok(!!window.App, 'window.App is defined'); 
				ok(!!window.App.callback, 'window.App.callback is defined'); 
			});
			
			test('Callback work good with wrong value', function AppDebug() {
				//test for initial value
				var 
				testCallbackWithNumber = 1;
				
				ok(App.callback(testCallbackWithNumber) === null);
			});
			
			test('Callback handle exception', function AppDebug() {
				//test for initial value
				var 
				testCallbackWithException = function() {
					throw "Exception";
				},
				logResult;
				
				ok(App.callback(testCallbackWithException) === null, "okay with no logger");
				
				/* Create a fake logger to test */ 
				
				window.App = $.extend(window.App, {
					
					// callback utility
					log: function (arg) {
						logResult = arg;
					}
					
				});
				
				App.callback(testCallbackWithException);
				
				ok(logResult.fx == "error" && logResult.args == "Exception", "okay with logger, exception logged");
				
				
			});
			
			test('Callback work and return value', function AppDebug() {
				//test for initial value
				var 
				returnedValue = "test",
				testCallbackReturn = function() {
					return returnedValue;
				};
				
				ok(App.callback(testCallbackReturn) === returnedValue, "Is returning the callback value");
			});
			
		}; // end run tests
		
		$(w).load(runTests);
		
	})(jQuery, window);
	</script>
</body>
</html>